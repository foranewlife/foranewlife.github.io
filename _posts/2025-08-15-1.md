---
title: '实空间电荷分析与化学键可视化方法调研'
date: 2025-08-15
modified: 2025-08-16
permalink: /posts/1/
tags:
  - 中文
  - 实空间电荷
---

{% include toc %}


# 实空间电荷分析与化学键可视化方法调研

作者：陈泳烁

## 引言

本文主要参考[1. 卢天 & 陈飞武. 原子电荷计算方法的对比. 物理化学学报 28, 1–18 (2012).](https://kns.cnki.net/kcms2/article/abstract?v=iLvembebNjxgst5Rto0pbaYzoPpr3vjbLPRB_oGPJ4-Dx048DrVZaAiR6nVIUcUWlZ2gqdS2rkGx-l3I6tM6tZfeWpDmx9f6AlBnHjzzINExmDq2IbsNFFyXHWjjbJKgohntWePjpA5G9_l_f2gRWXaIXpWtPE9WMh7sW4pw5x3kpxv5Y5KU6A==&uniplatform=NZKPT&language=CHS)、 [使用Multiwfn做IGMH分析非常清晰直观地展现化学体系中的相互作用](http://sobereva.com/621)。原子电荷, 即位于原子中心的点电荷, 是对化学体系中电荷分布最简单、 最直观的描述方式之一. 它有很多重要意义, 比如帮助化学工作者研究原子在各种化学环境中的状态、考察分子性质、预测反应位点。除了原子电荷，以图形化方式展现化学体系中的相互作用的方法也有助于化学工作者直观的了解相互作用在实空间下的分布。原子电荷模型在计算化学中已经有了很多实用价值，比如作为分子描述符用于药物虚拟筛选、在分子对接和分子动力学/蒙特卡罗模拟中描述静电作用、在量子力学(QM)与分子力学(MM)结合计算中表现QM区域原子对MM区域原子的静电作用势。在其它一些理论方法中也需要借助原子电荷, 如Pipek-Mezey 轨道定域化方法、电荷自洽的紧束缚密度泛函方法(SCC-DFTB)、Truhlar课题组开发的一系列溶剂模型(SM)等。相关引用请见[1. 卢天 & 陈飞武. 原子电荷计算方法的对比. 物理化学学报 28, 1–18 (2012).](https://kns.cnki.net/kcms2/article/abstract?v=iLvembebNjxgst5Rto0pbaYzoPpr3vjbLPRB_oGPJ4-Dx048DrVZaAiR6nVIUcUWlZ2gqdS2rkGx-l3I6tM6tZfeWpDmx9f6AlBnHjzzINExmDq2IbsNFFyXHWjjbJKgohntWePjpA5G9_l_f2gRWXaIXpWtPE9WMh7sW4pw5x3kpxv5Y5KU6A==&uniplatform=NZKPT&language=CHS)

本文的主要目的是综述可能应用在无轨道密度泛函理论（orbital free density functional theory， OFDFT）中的实空间电荷分析与化学键可视化方法，并探讨在OFDFT中应用这些方法进一步提升计算精度以推广OFDFT应用体系的可能性。由于OFDFT试用于计算简单金属和部分半导体体系的性质，本文将重点分析实空间电荷分析与化学键可视化方法在上述体系中的效果。

## 各种原子电荷计算方法的原理和特点

由于无轨道密度泛函理论（OFDFT）仅提供电子密度信息而不包含轨道波函数，因此只有基于电子密度的原子电荷计算方法才能在OFDFT中应用。通过对各种方法的筛选，仅有四种方法同时满足"仅依赖电子密度"和"不依赖经验参数"的要求：**Hirshfeld方法、ADCH方法、MK方法和AIM方法**。本节将详细介绍这四种适用于OFDFT的方法。

| 方法          | 是否仅依赖电子密度 | 是否不依赖参数 | 实现难度 |
|---------------|------------------|----------------|----------|
| Hirshfeld方法 | ✅               | ✅             | 🌟🌟      |
| ADCH方法      | ✅               | ✅             | 🌟🌟🌟    |
| MK方法        | ✅               | ✅             | 🌟🌟🌟    |
| AIM方法       | ✅               | ✅             | 🌟🌟🌟🌟  |
| Mulliken方法  |                  | ✅             | 🌟        |
| NPA方法       |                  | ✅             | 🌟🌟      |
| AOIM方法      |                  | ✅             | 🌟🌟🌟    |
| AM1-BCC方法   |                  |                | 🌟🌟🌟🌟  |
| MMFF94方法    |                  |                | 🌟🌟🌟🌟  |
| CM2方法       |                  |                | 🌟🌟🌟    |
| Gasteiger方法 |                  |                | 🌟🌟      |
| QEq方法       |                  |                | 🌟🌟🌟    |

### 2.1 Hirshfeld方法

Hirshfeld方法是1977年由Hirshfeld提出的基于电子密度的原子电荷计算方法，是最适合OFDFT应用的方法之一。

**基本原理：**
Hirshfeld方法的核心思想是将分子中的电子密度按照各原子在自由状态下的电子密度比例进行"模糊划分"。Hirshfeld电荷定义为：

$$q_A = -\int w_A(\mathbf{r})\Delta\rho(\mathbf{r})d\mathbf{r}$$

其中：
$$\Delta\rho(\mathbf{r}) = \rho(\mathbf{r}) - \sum_A\rho_A^0(\mathbf{r})$$
$$w_A(\mathbf{r}) = \frac{\rho_A^0(\mathbf{r})}{\sum_B\rho_B^0(\mathbf{r})}$$

上式中$\sum_A\rho_A^0(\mathbf{r})$代表所有原子在自由状态下的电子密度的加和，也称promolecule密度。$\Delta\rho$被称为变形密度，表现了原子形成分子后电子密度在弛豫过程中的变化。$w_A(\mathbf{r})$是A原子权重函数，它定义了整个实空间中属于A原子的区域。

与AIM的离散式原子空间划分相比，Hirshfeld对原子空间的划分是模糊的，原子空间彼此间存在交叠。Hirshfeld的划分方式有比较清楚的物理意义，Nalewajski和Parr从信息论角度证明了这种划分是允许电子密度在原子间转移的情况下，使原子在分子中和在自由状态下信息的距离(Kullback-Leibler相对熵)最小化的划分方式。

**方法特点：**
- **优点：** 
  - 仅依赖电子密度，完全适用于OFDFT
  - 不含任何经验参数
  - 基组依赖性小，数值稳定
  - 计算相对简单
  - 物理意义清晰，基于信息论有严格理论基础
  - 基组收敛性好，从3-21G开始就基本不发生变化
  
- **缺点：** 
  - 电荷数值普遍偏小，许多原子电荷的大小都不足0.1
  - 静电势重现性比较差
  - 偶极矩重现性不理想，从平均无符号误差(MUE)上看比Mulliken方法更差

### 2.2 ADCH方法（原子偶极矩校正的Hirshfeld方法）

ADCH方法是对Hirshfeld方法的改进，由卢天和陈飞武提出，旨在解决Hirshfeld电荷数值普遍偏小以及静电势重现性比较差的问题。我们认为这主要是忽略了原子偶极矩所引起的。

**基本原理：**
原子偶极矩可定义为：
$$\boldsymbol{\mu}_A = -\int w_A(\mathbf{r})\Delta\rho(\mathbf{r})(\mathbf{r} - \mathbf{r}_A)d\mathbf{r}$$

其中$\mathbf{r}_A$代表A原子核坐标。原子偶极矩是对原子空间内电子密度各向异性分布最重要的描述，它对分子可观测性质有直接贡献。然而Hirshfeld电荷计算公式的积分却相当于把原子空间内电子密度的分布球对称化了，完全掩盖了原子偶极矩的效应。因此提出了原子偶极矩校正的Hirshfeld布居(ADCH)。

在这个方法中首先计算各个原子的Hirshfeld电荷及原子偶极矩，然后将每个原子偶极矩按下式展开成为周围原子的校正电荷：
$$\boldsymbol{\mu}_A = \sum_B\Delta q_{AB}\mathbf{r}_B$$

其中$\Delta q_{AB}$代表展开A原子偶极矩后对B原子产生的校正电荷。把所有原子偶极矩展开成校正电荷后，将校正电荷累加到原始Hirshfeld电荷上就得到了ADCH电荷。

为了保证分子净电荷在校正过程中不变，展开任一原子A的偶极矩时需满足这个条件：
$$\sum_B \Delta q_{AB} = 0$$

同时，为了让原子偶极矩只展开到离当前原子较近的原子上，在实际计算时令上式和前式以拉格朗日乘子方式作为限制条件，使下式最小化来获得A原子对其它原子产生的校正电荷：
$$F_A(\Delta q_{A1}, \Delta q_{A2}, \ldots, \Delta q_{AN}) = \sum_B \frac{\Delta q_{AB}^2}{\nu_{AB}(r_{AB})}$$

其中$r_{AB}$是A、B原子间距离，N是总原子数，$\nu$是依赖于原子间距离的函数。它呈倒S形状，当$r_{AB}$由0变化到A、B原子范德华半径之和的过程中$\nu_{AB}$由1变化为0。因此，在原子偶极矩展开时，离当前原子越近的原子越容易获得校正电荷，与当前原子无相互作用的原子(距离超过范德华半径和)的电荷不会受到影响。

**方法特点：**
- **优点：** 
  - 保持了Hirshfeld方法仅依赖电子密度的特性
  - 显著改善了偶极矩重现性，ADCH是偶极矩保守的方法，因此ADCH电荷计算的偶极矩与偶极矩期望值完全相符
  - 电荷数值更加合理，校正后原子电荷普遍增大，电荷绝对值加和比校正前增加了一倍
  - 等效地考虑了原子偶极矩的效应
  - 基组稳定性好，与Hirshfeld方法一样从3-21G开始就基本不发生变化
  
- **缺点：** 
  - 计算复杂度比Hirshfeld方法高，需要求解拉格朗日乘子方程组

### 2.3 MK方法（Merz-Kollman静电势拟合方法）

在化学体系中，静电势(ESP)由原子核电荷和电子密度两部分贡献构成。MK方法是拟合静电势电荷计算方法中最常见的方法，属于ESP类方法的典型代表。

**基本原理：**
静电势的表达式为：
$$V(\mathbf{r}) = \sum_A \frac{Z_A}{|\mathbf{r}-\mathbf{r}_A|} - \int \frac{\rho(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}d\mathbf{r}'$$

对于离原子核较近的区域，总是由第一项主导，静电势数值为正，这是化学上不感兴趣的。而体系范德华表面以外的区域静电势可正可负，具有显著的化学意义，对于研究受体-配体结合方式、晶体堆叠方式，预测亲核/亲电反应位点，通过比较场分析(CoMFA)进行药物筛选等问题至关重要。

若在分子范德华表面外侧一定范围内选取一批格点，通过最小二乘法令原子电荷在这些点产生的静电势：
$$V_q(\mathbf{r}) = \sum_A \frac{q_A}{|\mathbf{r}-\mathbf{r}_A|}$$

对式上面计算的静电势拟合，就得到了拟合静电势电荷。拟合静电势电荷计算方法很多，主要差异在于格点位置的选取和拟合过程的细节。最常见的方法有Merz-Kollman (MK)方法、静电势获得的电荷(CHELP)方法和基于格点的CHELP (CHELPG)方法。CHELPG电荷在三者中旋转不变性最好，而通过多极矩重现性分析发现MK电荷质量比CHELP和CHELPG略好。

**方法特点：**
- **优点：** 
  - 仅依赖电子密度计算的静电势
  - 静电势重现性极好，由于MK电荷正是通过最小化静电势重现性误差得到的，因此它的RRMSE拥有理论最低值
  - 适合描述静电相互作用，若在分子范德华表面外侧精确静电势也能被较好重现时，才说明这种原子电荷适合研究分子间近距离静电作用
  - 物理意义明确，基于静电势这一可观测量
  
- **缺点：** 
  - 电荷对构象依赖性较大
  - 单一构象拟合的原子电荷不能体现原子的等价性，例如一氯丙烷中甲基的三个氢是化学等价的，但任何构象下拟合出来的这三个氢的电荷都不是全同的
  - 内部被包埋的原子电荷拟合不准确，这是由于这些原子距离拟合点过远所导致的
  - 计算量较大，需要生成大量格点并进行拟合计算
  - 这三个问题使得拟合静电势电荷用于分子动力学模拟等问题中可能导致错误的结果

### 2.4 AIM方法（分子中的原子理论）

Bader的分子中的原子(AIM)方法是典型的基于实空间划分的计算原子电荷的方法。AIM方法将电子密度零通量面定义为原子间的分界面，划分出的每个原子独立的空间被称为原子盆。

**基本原理：**
AIM方法基于电子密度的拓扑分析，将分子空间严格划分为原子盆。在分界面上没有电子密度梯度线穿过，即满足：
$$\nabla\rho(\mathbf{r}') \cdot \mathbf{n}(\mathbf{r}') = 0$$

这里$\mathbf{r}'$为原子界面上的任意点，$\mathbf{n}$为界面上的单位法矢量，$\rho$是电子密度函数。这样的空间划分从量子力学角度来看理论意义明确，在每个原子盆内维里定理得到满足。对原子盆内电子密度积分并与核电荷求差值即得到原子电荷：

$$q_A = Z_A - \int_{\Omega_A} \rho(\mathbf{r})d\mathbf{r}$$

这里$\Omega_A$代表A原子盆。

**特殊情况：**
注意以AIM的划分，在特殊条件下可能会出现不含原子核的原子盆，被称为赝原子。例如锂金属的两个锂原子间就存在赝原子，这是由金属键所导致的。另外还可能出现一个盆内包含不止一个原子核的情况，如KrH⁺体系中Kr由于电子分布范围过广而淹没了氢。这些情况都无法使用AIM方法来计算原子电荷。

**计算复杂性：**
在HF/6-31G*波函数级别下计算乙炔的AIM电荷时出现了前文谈到的"赝原子"，它位于两个碳原子之间。由于乙炔的对称性，我们将赝原子盆内电荷积分值平分给两个碳原子来获得碳的AIM电荷，但是当体系缺乏这样的对称性时就不能这样计算AIM电荷了。很多含有炔基的分子也都存在这样的赝原子，这使得AIM方法的适用性受到一定限制。值得一提的是，将基组替换为与6-31G*级别较为相似的SVP基组后赝原子随即消失，并变为碳-碳间的键临界点，这显示出在特殊情况下AIM的适用性明显受基组影响。

**方法特点：**
- **优点：** 
  - 严格的量子力学基础，理论意义明确
  - 仅依赖电子密度，完全适用于OFDFT
  - 空间划分唯一且无重叠，每个原子盆内维里定理得到满足
  - 不含任何经验参数
  
- **缺点：** 
  - 计算复杂度极高，耗时很长。例如计算Ephedrine分子全部AIM电荷总耗时为10.5 min，是计算波函数时间的近16倍
  - 可能出现"赝原子"（不含原子核的原子盆），使方法适用性受限
  - 可能出现一个盆内包含多个原子核的情况
  - 电荷数值明显大于其它方法所得电荷，例如丙酮的氧的电荷达到-1.35，氰化氢的氮的电荷高达-1.48
  - 对分子偶极矩基本没有重现能力，MUE高达3.00 Debye
  - 从电荷绝对值加和来看，AIM计算的电荷值(44.19)达到了Hirshfeld计算的电荷值(9.92)的将近5倍
  - 结果往往明显违背化学经验，对于研究反应位点并不适合

## 小结

通过对各种原子电荷计算方法的详细分析，可以看出在OFDFT框架下，只有四种方法能够满足"仅依赖电子密度"和"不依赖经验参数"的双重要求：Hirshfeld方法、ADCH方法、MK方法和AIM方法。

从实用性角度考虑，**Hirshfeld方法**是OFDFT中最推荐的方法，具有计算简单、基组稳定性好、物理意义清晰等优点；**ADCH方法**在需要更高精度时是很好的选择，能显著改善偶极矩重现性；**MK方法**适合需要精确描述静电相互作用的场合；而**AIM方法**尽管理论严格，但由于计算复杂度极高且结果常与化学直觉不符，在实际应用中价值有限。

这些方法为OFDFT在简单金属和半导体体系中的电荷分析提供了可靠的工具，有助于深入理解无轨道密度泛函理论中的电荷分布特征。

