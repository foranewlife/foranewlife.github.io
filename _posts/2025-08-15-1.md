---
title: '实空间电荷分析与化学键可视化方法调研（**草稿**）'
date: 2025-08-15
modified: 2025-08-22
permalink: /posts/1/
excerpt: "本文综述了适用于无轨道密度泛函理论（OFDFT）的实空间电荷分析与化学键可视化方法，包括Hirshfeld方法、ADCH方法、MK方法和AIM方法，探讨了它们的原理、特点及在简单金属和半导体体系中的应用潜力。"
tags:
  - 中文
  - 实空间电荷
  - 草稿

category:
  - 密度泛函理论

---

## 1 引言

本文主要参考卢天和陈飞武在《物理化学学报》上发表的原子电荷计算方法对比研究[^1]，以及Multiwfn软件在化学体系相互作用分析方面的应用[^2]。原子电荷, 即位于原子中心的点电荷, 是对化学体系中电荷分布最简单、 最直观的描述方式之一. 它有很多重要意义, 比如帮助化学工作者研究原子在各种化学环境中的状态、考察分子性质、预测反应位点。除了原子电荷，以图形化方式展现化学体系中的相互作用的方法也有助于化学工作者直观的了解相互作用在实空间下的分布。原子电荷模型在计算化学中已经有了很多实用价值，比如作为分子描述符用于药物虚拟筛选、在分子对接和分子动力学/蒙特卡罗模拟中描述静电作用、在量子力学(QM)与分子力学(MM)结合计算中表现QM区域原子对MM区域原子的静电作用势。在其它一些理论方法中也需要借助原子电荷, 如Pipek-Mezey 轨道定域化方法、电荷自洽的紧束缚密度泛函方法(SCC-DFTB)、Truhlar课题组开发的一系列溶剂模型(SM)等。相关文献的引用请参考[^1]。

本文的主要目的是综述可能应用在无轨道密度泛函理论（orbital free density functional theory， OFDFT）中的实空间电荷分析与化学键可视化方法，并探讨在OFDFT中应用这些方法进一步提升计算精度以推广OFDFT应用体系的可能性。由于OFDFT试用于计算简单金属和部分半导体体系的性质，本文将重点分析实空间电荷分析与化学键可视化方法在上述体系中的效果。

## 2 各种原子电荷计算方法的原理和特点

由于无轨道密度泛函理论（OFDFT）仅提供电子密度信息而不包含轨道波函数，因此只有基于电子密度的原子电荷计算方法才能在OFDFT中应用。通过对各种方法的筛选，仅有四种方法同时满足"仅依赖电子密度"和"不依赖经验参数"的要求：**Hirshfeld方法、ADCH方法、MK方法和AIM方法**。本节将详细介绍这四种适用于OFDFT的方法。

| 方法          | 是否仅依赖电子密度 | 是否不依赖参数 | 实现难度 |
|---------------|------------------|----------------|----------|
| Hirshfeld方法 | ✅               | ✅             | 🌟🌟      |
| ADCH方法      | ✅               | ✅             | 🌟🌟🌟    |
| MK方法        | ✅               | ✅             | 🌟🌟🌟    |
| AIM方法       | ✅               | ✅             | 🌟🌟🌟🌟  |
| Mulliken方法  |                  | ✅             | 🌟        |
| NPA方法       |                  | ✅             | 🌟🌟      |
| AOIM方法      |                  | ✅             | 🌟🌟🌟    |
| AM1-BCC方法   |                  |                | 🌟🌟🌟🌟  |
| MMFF94方法    |                  |                | 🌟🌟🌟🌟  |
| CM2方法       |                  |                | 🌟🌟🌟    |
| Gasteiger方法 |                  |                | 🌟🌟      |
| QEq方法       |                  |                | 🌟🌟🌟    |

### 2.1 Hirshfeld方法

Hirshfeld方法是1977年由Hirshfeld提出的基于电子密度的原子电荷计算方法，是最适合OFDFT应用的方法之一。

**基本原理：**
Hirshfeld方法的核心思想是将分子中的电子密度按照各原子在自由状态下的电子密度比例进行"模糊划分"。Hirshfeld电荷定义为：

$$q_A = -\int w_A(\mathbf{r})\Delta\rho(\mathbf{r})d\mathbf{r}$$

其中：
$$\Delta\rho(\mathbf{r}) = \rho(\mathbf{r}) - \sum_A\rho_A^0(\mathbf{r})$$
$$w_A(\mathbf{r}) = \frac{\rho_A^0(\mathbf{r})}{\sum_B\rho_B^0(\mathbf{r})}$$

上式中\\(\sum_A\rho_A^0(\mathbf{r})\\)代表所有原子在自由状态下的电子密度的加和，也称promolecule密度。\\(\Delta\rho\\)被称为变形密度，表现了原子形成分子后电子密度在弛豫过程中的变化。\\(w_A(\mathbf{r})\\)是A原子权重函数，它定义了整个实空间中属于A原子的区域。

与AIM的离散式原子空间划分相比，Hirshfeld对原子空间的划分是模糊的，原子空间彼此间存在交叠。Hirshfeld的划分方式有比较清楚的物理意义，Nalewajski和Parr从信息论角度证明了这种划分是允许电子密度在原子间转移的情况下，使原子在分子中和在自由状态下信息的距离(Kullback-Leibler相对熵)最小化的划分方式。[^1]

**方法特点：**
- **优点：** 
  - 仅依赖电子密度，完全适用于OFDFT
  - 不含任何经验参数
  - 计算相对简单
  - 物理意义清晰，基于信息论有严格理论基础
  
- **缺点：** 
  - 电荷数值普遍偏小，许多原子电荷的大小都不足0.1
  - 静电势重现性比较差
  - 偶极矩重现性不理想，从平均无符号误差(MUE)上看比Mulliken方法更差


### 2.2 ADCH方法（原子偶极矩校正的Hirshfeld方法）

ADCH方法是对Hirshfeld方法的改进，由卢天和陈飞武提出，旨在解决Hirshfeld电荷数值普遍偏小以及静电势重现性比较差的问题。这主要是由于忽略了原子偶极矩所引起的。

**基本原理：**
原子偶极矩可定义为：
$$\boldsymbol{\mu}_A = -\int w_A(\mathbf{r})\Delta\rho(\mathbf{r})(\mathbf{r} - \mathbf{r}_A)d\mathbf{r}$$

其中\\(\mathbf{r}_A\\)代表A原子核坐标。原子偶极矩是对原子空间内电子密度各向异性分布最重要的描述，它对分子可观测性质有直接贡献。然而Hirshfeld电荷计算公式的积分却相当于把原子空间内电子密度的分布球对称化了，完全掩盖了原子偶极矩的效应。因此提出了原子偶极矩校正的Hirshfeld布居(ADCH)。

在这个方法中首先计算各个原子的Hirshfeld电荷及原子偶极矩，然后将每个原子偶极矩按下式展开成为周围原子的校正电荷：
$$\boldsymbol{\mu}_A = \sum_B\Delta q_{AB}\mathbf{r}_B$$

其中\\(\Delta q_{AB}\\)代表展开A原子偶极矩后对B原子产生的校正电荷。把所有原子偶极矩展开成校正电荷后，将校正电荷累加到原始Hirshfeld电荷上就得到了ADCH电荷。

为了保证分子净电荷在校正过程中不变，展开任一原子A的偶极矩时需满足这个条件：
$$\sum_B \Delta q_{AB} = 0$$

同时，为了让原子偶极矩只展开到离当前原子较近的原子上，在实际计算时令上式和前式以拉格朗日乘子方式作为限制条件，使下式最小化来获得A原子对其它原子产生的校正电荷：
$$F_A(\Delta q_{A1}, \Delta q_{A2}, \ldots, \Delta q_{AN}) = \sum_B \frac{\Delta q_{AB}^2}{\nu_{AB}(r_{AB})}$$

其中\\(r_{AB}\\)是A、B原子间距离，N是总原子数，\\(\nu\\)是依赖于原子间距离的函数。它呈倒S形状，当\\(r_{AB}\\)由0变化到A、B原子范德华半径之和的过程中\\(\nu_{AB}\\)由1变化为0。因此，在原子偶极矩展开时，离当前原子越近的原子越容易获得校正电荷，与当前原子无相互作用的原子(距离超过范德华半径和)的电荷不会受到影响。

**方法特点：**
- **优点：** 
  - 保持了Hirshfeld方法仅依赖电子密度的特性
  - 显著改善了偶极矩重现性，ADCH是偶极矩保守的方法，因此ADCH电荷计算的偶极矩与偶极矩期望值完全相符
  - 电荷数值更加合理，校正后原子电荷普遍增大，电荷绝对值加和比校正前增加了一倍
  - 等效地考虑了原子偶极矩的效应
  
- **缺点：** 
  - 计算复杂度比Hirshfeld方法高，需要求解拉格朗日乘子方程组

### 2.3 MK方法（Merz-Kollman静电势拟合方法）

在化学体系中，静电势(ESP)由原子核电荷和电子密度两部分贡献构成。MK方法是拟合静电势电荷计算方法中最常见的方法，属于ESP类方法的典型代表。

**基本原理：**
静电势的表达式为：
$$V(\mathbf{r}) = \sum_A \frac{Z_A}{|\mathbf{r}-\mathbf{r}_A|} - \int \frac{\rho(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}d\mathbf{r}'$$

对于离原子核较近的区域，总是由第一项主导，静电势数值为正，这是化学上不感兴趣的。而体系范德华表面以外的区域静电势可正可负，具有显著的化学意义，对于研究受体-配体结合方式、晶体堆叠方式，预测亲核/亲电反应位点，通过比较场分析(CoMFA)进行药物筛选等问题至关重要。

若在分子范德华表面外侧一定范围内选取一批格点，通过最小二乘法令原子电荷在这些点产生的静电势：
$$V_q(\mathbf{r}) = \sum_A \frac{q_A}{|\mathbf{r}-\mathbf{r}_A|}$$

对式上面计算的静电势拟合，就得到了拟合静电势电荷。拟合静电势电荷计算方法很多，主要差异在于格点位置的选取和拟合过程的细节。最常见的方法有Merz-Kollman (MK)方法、静电势获得的电荷(CHELP)方法和基于格点的CHELP (CHELPG)方法。CHELPG电荷在三者中旋转不变性最好，而通过多极矩重现性分析发现MK电荷质量比CHELP和CHELPG略好。

**方法特点：**
- **优点：** 
  - 仅依赖电子密度计算的静电势
  - 静电势重现性极好，由于MK电荷正是通过最小化静电势重现性误差得到的，因此它的RRMSE拥有理论最低值
  - 适合描述静电相互作用，若在分子范德华表面外侧精确静电势也能被较好重现时，才说明这种原子电荷适合研究分子间近距离静电作用
  - 物理意义明确，基于静电势这一可观测量
  
- **缺点：** 
  - 电荷对构象依赖性较大
  - 单一构象拟合的原子电荷不能体现原子的等价性，例如一氯丙烷中甲基的三个氢是化学等价的，但任何构象下拟合出来的这三个氢的电荷都不是全同的
  - 内部被包埋的原子电荷拟合不准确，这是由于这些原子距离拟合点过远所导致的
  - 计算量较大，需要生成大量格点并进行拟合计算
  - 这三个问题使得拟合静电势电荷用于分子动力学模拟等问题中可能导致错误的结果

### 2.4 AIM方法（分子中的原子理论）

Bader的分子中的原子(AIM)方法是典型的基于实空间划分的计算原子电荷的方法。AIM方法将电子密度零通量面定义为原子间的分界面，划分出的每个原子独立的空间被称为原子盆。

**基本原理：**
AIM方法基于电子密度的拓扑分析，将分子空间严格划分为原子盆。在分界面上没有电子密度梯度线穿过，即满足：
$$\nabla\rho(\mathbf{r}') \cdot \mathbf{n}(\mathbf{r}') = 0$$

这里\\(\mathbf{r}'\\)为原子界面上的任意点，\\(\mathbf{n}\\)为界面上的单位法矢量，\\(\rho\\)是电子密度函数。这样的空间划分从量子力学角度来看理论意义明确，在每个原子盆内维里定理得到满足。对原子盆内电子密度积分并与核电荷求差值即得到原子电荷：

$$q_A = Z_A - \int_{\Omega_A} \rho(\mathbf{r})d\mathbf{r}$$

这里\\(\Omega_A\\)代表A原子盆。

**特殊情况：**
注意以AIM的划分，在特殊条件下可能会出现不含原子核的原子盆，被称为赝原子。例如锂金属的两个锂原子间就存在赝原子，这是由金属键所导致的。另外还可能出现一个盆内包含不止一个原子核的情况，如KrH⁺体系中Kr由于电子分布范围过广而淹没了氢。这些情况都无法使用AIM方法来计算原子电荷。

**计算复杂性：**
在HF/6-31G*波函数级别下计算乙炔的AIM电荷时出现了前文谈到的"赝原子"，它位于两个碳原子之间。由于乙炔的对称性，我们将赝原子盆内电荷积分值平分给两个碳原子来获得碳的AIM电荷，但是当体系缺乏这样的对称性时就不能这样计算AIM电荷了。很多含有炔基的分子也都存在这样的赝原子，这使得AIM方法的适用性受到一定限制。值得一提的是，将基组替换为与6-31G*级别较为相似的SVP基组后赝原子随即消失，并变为碳-碳间的键临界点，这显示出在特殊情况下AIM的适用性明显受基组影响。

**方法特点：**
- **优点：** 
  - 严格的量子力学基础，理论意义明确
  - 仅依赖电子密度，完全适用于OFDFT
  - 空间划分唯一且无重叠，每个原子盆内维里定理得到满足
  - 不含任何经验参数
  
- **缺点：** 
  - 计算复杂度极高，耗时很长。例如计算Ephedrine分子全部AIM电荷总耗时为10.5 min，是计算波函数时间的近16倍
  - 可能出现"赝原子"（不含原子核的原子盆），使方法适用性受限
  - 可能出现一个盆内包含多个原子核的情况
  - 电荷数值明显大于其它方法所得电荷，例如丙酮的氧的电荷达到-1.35，氰化氢的氮的电荷高达-1.48
  - 对分子偶极矩基本没有重现能力，MUE高达3.00 Debye
  - 从电荷绝对值加和来看，AIM计算的电荷值(44.19)达到了Hirshfeld计算的电荷值(9.92)的将近5倍
  - 结果往往明显违背化学经验，对于研究反应位点并不适合

## 3 相互作用可视化方法

当研究者面对一个未知的化学体系，仅有电荷密度信息而不确定体系中存在何种相互作用时，选择合适的可视化分析方法至关重要。根据卢天在《Angewandte Chemie》上发表的综述文章[^3]，结合OFDFT的应用需求，以下方法按推荐优先级介绍：

| 方法 | 适用相互作用类型 | 输入要求 | 计算复杂度 | 主要优点 | 主要缺点 |
|------|-----------------|----------|------------|----------|----------|
| **IRI方法** | 所有类型相互作用 | 🟢仅需电荷密度 | 🌟🌟 | 可同时显示共价和非共价相互作用 | 相对较新，应用案例较少 |
| **NCI方法** | 非共价相互作用 | 🟢仅需电荷密度 | 🌟🌟 | 应用最广泛，可基于实验数据 | 无法同时显示共价键，网格要求高 |
| **IGMH方法** | 片段间相互作用 | 🟢仅需电荷密度 | 🌟🌟🌟 | 可定义片段，网格要求低 | 需要预先定义分子片段 |
| **ESP分析** | 静电主导相互作用 | 🟢仅需电荷密度 | 🌟🌟 | 物理意义明确，预测能力强 | 仅适用于静电相互作用 |
| **变形密度** | 成键电荷变化 | 🟢仅需电荷密度 | 🌟🌟 | 物理意义清晰 | 应用相对较少 |
| **拉普拉斯算子** | 电荷集中/耗散 | 🟢仅需电荷密度 | 🌟🌟 | QTAIM理论基础 | 重原子成键显示差 |

### 3.1 IRI方法（推荐首选）

**基本原理：**
相互作用区域指示器（Interaction Region Indicator, IRI）方法是NCI方法的扩展，由卢天等人于2021年提出。IRI方法的核心优势在于能够在单一图像中同时显示共价和非共价相互作用。IRI函数定义为：

$$IRI(r) = \frac{|\nabla\rho(r)|}{[\rho(r)]^a}$$

其中参数a经验性地选择为1.1，以最好地平衡各种相互作用的图形表示。通常采用IRI = 1.0 a.u.的等值面，但可根据具体体系略作调整。

**方法特点：**
- **优点：** 
  - 完全适用于OFDFT，仅需电荷密度及其导数
  - 可同时显示共价键、配位键、氢键、范德华相互作用等所有类型相互作用
  - 图像信息丰富，一张图可获得体系的完整相互作用图景
  - 能够追踪化学反应过程中相互作用的变化
  
- **缺点：** 
  - 方法相对较新（2021年提出），应用案例相对较少
  - 对于复杂大体系，图像可能较为复杂

**应用实例：**
以锆茂二氯化物(ZrCp₂Cl₂)为例，IRI等值面清晰显示了：
- C─C和C─H共价键（深蓝色等值面，表示强相互作用）
- Zr-Cl配位键（蓝色等值面）
- 配体间位阻效应（红色区域）
- 范德华相互作用（绿色区域）

在SN₂反应过程分析中，IRI方法能够直观显示OH⁻与CH₃CH₂Br反应过程中：
- 反应初期：OH⁻和CH₃CH₂Br间形成弱相互作用络合物（绿色等值面）
- 反应进行：O-C间相互作用逐渐增强（等值面颜色由绿变蓝）
- 反应结束：C-Br键断裂，仅剩范德华相互作用

**使用建议：**
对于未知体系，建议首先使用IRI方法进行全面的相互作用扫描，获得体系相互作用的整体图景，然后根据需要使用其他专门方法进行深入分析。

### 3.2 NCI方法（经典选择）

**基本原理：**
非共价相互作用（Noncovalent Interaction, NCI）方法由Johnson等人于2010年提出，是目前应用最广泛的弱相互作用可视化方法。该方法基于约化密度梯度（RDG）函数：

$$RDG(r) = \frac{1}{2(3\pi^2)^{1/3}} \frac{|\nabla\rho(r)|}{\rho(r)^{4/3}}$$

在低密度区域（通常ρ < 0.05 a.u.），RDG等值面（通常取0.5）能够很好地展现非共价相互作用区域。通过sign(λ₂)ρ函数着色来区分相互作用的强度和类型。

**方法特点：**
- **优点：** 
  - 应用最为广泛，有大量成功应用案例
  - 可基于高精度晶体衍射实验数据进行分析
  - 对于非共价相互作用的显示效果优秀
  - 理论基础扎实，方法成熟
  
- **缺点：** 
  - 无法同时显示共价键
  - 对网格质量要求较高
  - 仅适用于非共价相互作用的分析

**应用实例：**
在鸟嘌呤-胞嘧啶碱基对吸附在周边芳环上的体系中，NCI分析清晰显示了：
- 鸟嘌呤和胞嘧啶间的三个氢键（小的蓝色等值面）
- 碱基对与周边芳环间的π-π堆积效应（宽大的绿色等值面）
- 五元环和六元环内的位阻效应（红色等值面）

在NaNO₃分子中，NCI图清晰展现了：
- 两个Na─O离子键（蓝色区域）
- 中心区域的位阻效应（红色区域，由Na-N近距离接触引起）

**使用建议：**
当确定体系主要包含弱相互作用（氢键、范德华力、π-π相互作用等）时，NCI方法是最佳选择。对于OFDFT应用，特别适合分析金属体系中的弱相互作用。

### 3.3 IGMH方法（片段分析专用）

**基本原理：**
基于Hirshfeld分割的独立梯度模型（IGMH）方法是IGM方法的改进版本，由卢天等人提出。该方法将自由态原子密度替换为基于Hirshfeld分割的原子电子密度：

$$\rho_i^{IGMH}(r) = \rho(r)w_i(r)$$

其中$w_i(r) = \rho_i^{free}/\rho^{pro}$是Hirshfeld原子权重函数。IGMH定义δg函数来显示相互作用区域，并可分别计算分子间(δg^{inter})和分子内(δg^{intra})相互作用。

**方法特点：**
- **优点：** 
  - 可通过定义片段来重点分析感兴趣的相互作用
  - 网格质量要求相对较低
  - 提供定量指标来衡量原子和原子对的贡献
  - 等值面质量优于原始IGM方法
  - 可以控制显示不同强度的相互作用
  
- **缺点：** 
  - 需要预先合理定义分子片段
  - 计算复杂度略高于NCI和IRI

**应用实例：**
在尿素晶体的相互作用分析中，通过将中心尿素分子和周围分子定义为不同片段，IGMH清晰显示了：
- 尿素分子间的多重氢键（蓝色等值面）
- 明显的范德华相互作用（绿色等值面）

在环碳与富勒烯复合物的研究中，通过调节δg^{inter}的等值面大小：
- 大等值面：显示最强的环碳-富勒烯π-π相互作用
- 中等等值面：显示环碳-环碳间的π-π相互作用
- 小等值面：显示所有弱范德华相互作用

通过等值面面积的变化，IGMH能够直观反映相互作用强度随环碳尺寸的变化规律。

**使用建议：**
当需要重点分析特定分子片段间的相互作用时，IGMH是最佳选择。特别适用于主客体化学、表面吸附、蛋白质-配体相互作用等需要区分不同组分间相互作用的场合。

### 3.4 ESP分析（静电相互作用预测）

**基本原理：**
静电势（Electrostatic Potential, ESP）分析基于静电势函数：

$$V(r) = \sum_A \frac{Z_A}{|r-r_A|} - \int \frac{\rho(r')}{|r-r'|}dr'$$

ESP分析的核心思想是分子倾向于通过互补的ESP符号进行相互作用，以最大化静电吸引。这被称为ESP互补性原理。

**方法特点：**
- **优点：** 
  - 物理意义明确，基于可观测的静电势
  - 对静电主导的相互作用预测能力强
  - 可以预测分子间相互作用的相对稳定性
  - 适用于σ-空穴相互作用的分析
  - 能够解释分子构象选择的微观机理
  
- **缺点：** 
  - 仅适用于静电作用占主导的体系
  - 对于色散力主导的体系效果有限

**应用实例：**
在N₂二聚体的五种构型稳定性研究中，通过叠加单体ESP图：
- Z构型：红蓝区域重叠最多，静电互补性最强，稳定性最高
- T构型：具有较好的ESP互补性，稳定性较高
- X构型：既有相同符号重叠（排斥）又有相反符号重叠（吸引），整体静电稳定化较弱
- L构型：相同符号区域完全重叠，静电排斥强，稳定性最差

在SeCl₂分子的σ-空穴分析中，ESP着色的范德华表面清晰显示了：
- Se原子沿Se-Cl键轴方向的σ-空穴区域（强正电势，+32 kcal/mol）
- Cl原子一侧的较弱正电势区域
- 预测SeCl₂能够形成卤键和硫属键，且硫属键更强

**使用建议：**
当体系可能包含强极性分子、离子或σ-空穴相互作用时，ESP分析是理解相互作用本质的重要工具。特别适用于预测分子识别、晶体堆积、催化活性位点等静电主导的过程。

### 3.5 变形密度方法（成键电荷变化可视化）

**基本原理：**
变形密度(\\(\rho_{def}\\))定义为实际电子密度与前分子密度的差值：

$$\rho_{def}(r) = \rho(r) - \sum_A\rho_A^0(r)$$

它反映了由于原子间相互作用导致的电子密度分布的所有变化。正值区域表示电子密度增加（通常在成键区域），负值区域表示电子密度减少（通常在原子外围区域）。

**方法特点：**
- **优点：** 
  - 物理意义清晰直观
  - 适用于任何元素间的成键分析
  - 可视化效果简洁明了
  - 能清楚显示共价键的形成过程
  
- **缺点：** 
  - 应用相对较少
  - 主要显示共价相互作用
  - 对弱相互作用的显示不如专门方法

**应用实例：**
在[Re₂Cl₈]²⁻离子的分析中，变形密度等高线图清晰显示：
- Re-Re键区域电子密度显著增加（红色实线）
- Re-Cl键区域电子密度增加（红色实线）
- 原子外围区域电子密度减少（蓝色虚线）

这直观地展现了金属-金属键和金属-配体键的形成过程中电子的重新分布。

**使用建议：**
当需要清晰理解成键过程中电子密度变化，特别是共价键形成机理时，变形密度是简单有效的工具。对于OFDFT应用，适合分析金属键和共价键的电子结构特征。

### 3.6 拉普拉斯算子方法（电荷分布特征）

**基本原理：**
电子密度的拉普拉斯算子$\nabla^2\rho$在QTAIM理论中广泛应用。显著的负值表示电子密度在相应位置局域浓缩（如共价键区域），正值表示电子密度耗散（如原子间非键区域）。

**方法特点：**
- **优点：** 
  - 有严格的QTAIM理论基础
  - 计算相对简单
  - 与键临界点分析配合效果好
  
- **缺点：** 
  - 图形表示效果不如ELF和LOL理想
  - 对重原子间的共价键显示效果差
  - 数值范围很宽，图形化表示困难

**使用建议：**
主要用作QTAIM分析的辅助工具，结合键临界点、环临界点等拓扑分析使用，不推荐作为主要的可视化分析方法。

### 3.7 其他相互作用可视化方法对比

以下是其他常见的相互作用可视化方法，虽然不能直接应用于OFDFT，但在传统量子化学计算中仍有重要应用价值：

| 方法 | 适用相互作用类型 | 输入要求 | 计算复杂度 | 主要优点 | 主要缺点 |
|------|-----------------|----------|------------|----------|----------|
| **ELF方法** | 电子定域化 | 🔴需要波函数 | 🌟🌟 | 经典方法，应用广泛 | 对键级敏感性有限，不适用OFDFT |
| **LOL方法** | 轨道定域化 | 🔴需要波函数 | 🌟🌟 | 可视化效果优于ELF | 定义相对复杂，不适用OFDFT |
| **价电子密度** | 价层成键 | 🔴需要波函数 | 🌟 | 计算简单直观 | 应用价值被低估，不适用OFDFT |
| **IGM方法** | 片段间相互作用 | 🟡仅需原子坐标 | 🌟🌟 | 计算最快速，无需量化计算 | 等值面过于臃肿，着色不理想 |
| **mIGM方法** | 片段间相互作用 | 🟡仅需原子坐标 | 🌟🌟 | 平衡了速度和质量 | 精度略低于IGMH |
| **aNCI/aIGM** | 动态环境相互作用 | 🔴需MD轨迹数据 | 🌟🌟🌟🌟 | 可分析动态过程 | 需要轨迹数据，计算量大 |
| **Hirshfeld表面** | 分子环境相互作用 | 🟡仅需原子坐标 | 🌟🌟 | 适用于晶体分析 | 仅显示表面接触 |
| **vdW势能分析** | 范德华相互作用 | 🟡仅需原子坐标 | 🌟🌟 | 预测vdW主导的相互作用 | 仅适用于非极性体系 |

**说明：**
- 🟢 仅需电荷密度的方法：完全适用于OFDFT
- 🟡 仅需原子坐标的方法：可作为OFDFT的快速筛选工具
- 🔴 需要波函数或特殊数据的方法：不适用于OFDFT

## 体系计算

常见的OFDFT可以计算的体系包括，简单金属（标准结构、团簇、随机结构），III-V族半导体（标准结构、团簇、随机结构）。我们以这些体系为例，分析这些体系的特点并分析OFDFT的误差。



## 方法选择建议

**对于OFDFT应用的推荐策略：**

1. **初步筛选**：首先使用**IRI方法**获得体系相互作用的全貌
2. **深入分析**：
   - 如发现主要为非共价相互作用，使用**NCI方法**进行精细分析
   - 如需要分析特定片段间相互作用，使用**IGMH方法**
   - 如体系包含强极性分子，补充**ESP分析**
3. **特殊情况**：
   - 对于共价键的详细分析，使用**变形密度**方法
   - 需要定量分析时，结合QTAIM的键临界点分析

**计算资源考虑：**
- 大体系快速筛选：IRI > NCI > ESP分析
- 高精度要求：IGMH > IRI > NCI  
- 最低计算成本：ESP分析 > 拉普拉斯算子


## 小结

通过对各种原子电荷计算方法和相互作用可视化方法的详细分析，可以看出在OFDFT框架下，针对不同的分析需求有相应的最优方法选择。

**原子电荷计算方面**，只有四种方法能够满足"仅依赖电子密度"和"不依赖经验参数"的双重要求：Hirshfeld方法、ADCH方法、MK方法和AIM方法。从实用性角度考虑，**Hirshfeld方法**是OFDFT中最推荐的方法，具有计算简单、基组稳定性好、物理意义清晰等优点；**ADCH方法**在需要更高精度时是很好的选择，能显著改善偶极矩重现性；**MK方法**适合需要精确描述静电相互作用的场合；而**AIM方法**尽管理论严格，但由于计算复杂度极高且结果常与化学直觉不符，在实际应用中价值有限。

**相互作用可视化方面**，当面对未知体系仅有电荷密度信息时，推荐采用分层分析策略：
1. **首选IRI方法**进行全面的相互作用筛选，获得体系的完整相互作用图景
2. 根据IRI结果，使用**NCI方法**深入分析非共价相互作用，使用**IGMH方法**分析片段间特定相互作用
3. 对于静电主导的体系，**ESP分析**能提供互补的预测信息
4. **变形密度**和**拉普拉斯算子**方法适合作为共价键分析的辅助工具

这些方法为OFDFT在简单金属和半导体体系中的电荷分析和相互作用研究提供了完整的工具包，有助于深入理解无轨道密度泛函理论中的电荷分布特征和相互作用本质，为进一步提升OFDFT的计算精度和拓展应用范围提供了重要的理论指导。

---

## 参考文献

[^1]: 卢天, 陈飞武. 原子电荷计算方法的对比. 物理化学学报 28, 1–18 (2012). DOI: [10.3866/PKU.WHXB20121023](https://kns.cnki.net/kcms2/article/abstract?v=iLvembebNjxgst5Rto0pbaYzoPpr3vjbLPRB_oGPJ4-Dx048DrVZaAiR6nVIUcUWlZ2gqdS2rkGx-l3I6tM6tZfeWpDmx9f6AlBnHjzzINExmDq2IbsNFFyXHWjjbJKgohntWePjpA5G9_l_f2gRWXaIXpWtPE9WMh7sW4pw5x3kpxv5Y5KU6A==&uniplatform=NZKPT&language=CHS)

[^2]: 使用Multiwfn做IGMH分析非常清晰直观地展现化学体系中的相互作用. Sobereva. 网址: [http://sobereva.com/621](http://sobereva.com/621)

[^3]: Lu, T. Visualization Analysis of Covalent and Noncovalent Interactions in Real Space. Angew Chem Int Ed 64, e202504895 (2025).
